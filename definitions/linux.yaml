# Linux specific artifacts.

name: AnacronFiles
doc: Anacron files.
sources:
- type: FILE
  attributes:
    paths:
      - '/etc/anacrontab'
      - '/etc/cron.daily'
      - '/etc/cron.hourly'
      - '/etc/cron.monthly'
      - '/etc/cron.weekly'
      - '/var/spool/anacron/cron.daily'
      - '/var/spool/anacron/cron.hourly'
      - '/var/spool/anacron/cron.monthly'
      - '/var/spool/anacron/cron.weekly'
labels: [Configuration Files]
supported_os: [Linux]
---
name: LinuxCronTabs
doc: Crontab files.
sources:
- type: FILE
  attributes:
    paths:
      - '/etc/crontab'
      - '/etc/cron.d/*'
      - '/var/spool/cron/*'
labels: [Configuration Files]
supported_os: [Linux]
---
name: LinuxAtJobs
doc: Linux at jobs.
sources:
- type: FILE
  attributes:
    paths:
      - '/var/spool/at/*'
labels: [Configuration Files]
supported_os: [Linux]
---
name: LinuxCronTabs
doc: Crontab files.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '/etc/crontab'
      - '/etc/cron.d/*'
      - '/var/spool/cron/*'
labels: [Configuration Files]
supported_os: [Linux]
---
name: LinuxAtJobs
doc: Linux at jobs.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '/var/spool/at/*'
labels: [Configuration Files]
supported_os: [Linux]
---
name: HostAccessPolicyConfiguration
doc: Linux files related to host access policy configuration.
sources:
- type: FILE
  attributes:
    paths:
      - '/etc/hosts.allow'
      - '/etc/hosts.deny'
labels: [Configuration Files]
supported_os: [Linux]
---
name: LinuxPasswd
doc: Linux passwd file.
sources:
- type: FILE
  attributes: {paths: ['/etc/passwd']}
labels: [Authentication]
supported_os: [Linux]
---
name: RootUserShellConfigs
doc: Linux root shell configuration files.
sources:
- type: FILE
  attributes:
    paths:
      - '/root/.bashrc'
      - '/root/.cshrc'
      - '/root/.ksh'
      - '/root/.logout'
      - '/root/.profile'
      - '/root/.tcsh'
      - '/root/.zlogin'
      - '/root/.zlogout'
      - '/root/.zprofile'
      - '/root/.zprofile'
labels: [Configuration Files]
supported_os: [Linux]
---
name: DebianPackagesStatus
doc: Linux dpkg status file.
sources:
- type: FILE
  attributes: {paths: ['/var/lib/dpkg/status']}
labels: [Software]
supported_os: [Linux]
---
name: LinuxAuditLogs
doc: Linux audit log files.
sources:
- type: FILE
  attributes: {paths: ['/var/log/audit/*']}
labels: [Logs]
supported_os: [Linux]
---
name: LinuxAuthLogs
doc: Linux auth log files.
sources:
- type: FILE
  attributes: {paths: ['/var/log/auth.log*']}
labels: [Logs, Authentication]
supported_os: [Linux]
---
name: LinuxCronLogs
doc: Linux cron log files.
sources:
- type: FILE
  attributes: {paths: ['/var/log/cron.log*']}
labels: [Logs]
supported_os: [Linux]
---
name: LoginPolicyConfiguration
doc: Linux files related to login policy configuration.
sources:
- type: FILE
  attributes:
    paths:
      - '/etc/netgroup'
      - '/etc/nsswitch.conf'
      - '/etc/passwd'
      - '/etc/shadow'
      - '/etc/security/access.conf'
      - '/root/.k5login'
labels: [Authentication, Configuration Files]
supported_os: [Linux]
---
name: GlobalShellConfigs
doc: Linux global shell configuration files.
sources:
- type: FILE
  attributes:
    paths:
      - '/etc/bash.bashrc'
      - '/etc/csh.cshrc'
      - '/etc/csh.login'
      - '/etc/csh.logout'
      - '/etc/profile'
      - '/etc/zsh/zlogin'
      - '/etc/zsh/zlogout'
      - '/etc/zsh/zprofile'
      - '/etc/zsh/zshenv'
      - '/etc/zsh/zshrc'
labels: [Configuration Files]
supported_os: [Linux]
---
name: LinuxWtmp
doc: Linux wtmp file.
sources:
- type: FILE
  attributes: {paths: ['/var/log/wtmp']}
labels: [Logs, Authentication]
provides: [users.username, users.last_logon]
supported_os: [Linux]
---
name: NetgroupConfiguration
doc: Linux netgroup configuration.
sources:
- type: FILE
  attributes: {paths: ['/etc/netgroup']}
labels: [Authentication, Configuration Files]
provides: [users.username]
supported_os: [Linux]
---
name: ASLREnabled 
doc: Kernel ASLR state.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '/proc/sys/kernel/randomize_va_space'
labels: [System]
supported_os: [Linux]
---
name: IgnoreICMPBroadcasts
doc: Whether the systrem ignores ICMP pings.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '/proc/sys/net/ipv4/icmp_echo_ignore_broadcasts'
labels: [Network, System]
supported_os: [Linux]
---
name: KernelBootloader
doc: Bootloader state acquired from the kernel.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '/proc/sys/kernel/bootloader_type'
      - '/proc/sys/kernel/bootloader_version'
labels: [System]
supported_os: [Linux]
---
name: KernelModuleProvenance
doc: Taint state of loaded modules (binary blobs, unsigned modules etc).
collectors:
- collector_type: FILE
  args:
    path_list:
      - '/proc/sys/kernel/tainted'
labels: [System]
supported_os: [Linux]
---
name: KernelModuleRestrictions
doc: Module loading options and taint state.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '/proc/sys/kernel/kexec_load_disabled'
      - '/proc/sys/kernel/modules_disabled'
labels: [System]
supported_os: [Linux]
---
name: NetworkIpForwardingState
doc: IP forwarding states.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '/proc/sys/net/ipv*/conf/*/forwarding'
      - '/proc/sys/net/ipv4/conf/*/mc_forwarding'
      - '/proc/sys/net/ipv4/ip_forward'
labels: [Network, System]
supported_os: [Linux]
---
name: NetworkPathFilteringSettings
doc: States that determine how the system responds to route manipulation.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '/proc/sys/net/ipv*/conf/*/accept_source_route'
      - '/proc/sys/net/ipv4/conf/*/rp_filter'
      - '/proc/sys/net/ipv4/conf/*/log_martians'
labels: [Network, System]
supported_os: [Linux]
---
name: NetworkRedirectState
doc: Redirect send/receive states.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '/proc/sys/net/ipv*/conf/*/accept_redirects'
      - '/proc/sys/net/ipv4/conf/*/secure_redirects'
      - '/proc/sys/net/ipv4/conf/*/send_redirects'
labels: [Network, System]
supported_os: [Linux]
---
name: ProcMounts
doc: Current mounted filesystems.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '/proc/mounts'
labels: [System]
supported_os: [Linux]
---
name: RestrictedDmesgReadPrivileges
doc: Restrict whether non-privileged users can read dmesg.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '/proc/sys/kernel/dmesg_restrict'
labels: [System]
supported_os: [Linux]
---
name: RestrictedKernelPointerReadPrivileges
doc: Memory address obfuscation settings.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '/proc/sys/kernel/kptr_restrict'
      - '/proc/sys/kernel/randomize_va_space'
labels: [System]
supported_os: [Linux]
---
name: SecureSuidCoreDumps
doc: Security controls for suid core dumps.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '/proc/sys/fs/suid_dumpable'
labels: [System]
supported_os: [Linux]
---
name: SecureFsLinks
doc: Security controls to restrict operations on links in world writable directories.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '/proc/sys/fs/protected_hardlinks'
      - '/proc/sys/fs/protected_symlinks'
labels: [System]
supported_os: [Linux]
---
name: SyncookieState
doc: Whether the system uses syncookies.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '/proc/sys/net/ipv4/tcp_syncookies'
labels: [Network, System]
supported_os: [Linux]
---
name: ProcSys
doc: Linux sysctl settings obtained from /proc/sys.
collectors:
- collector_type: ARTIFACT
  args:
    artifact_list:
      - 'ASLREnabled' 
      - 'IgnoreICMPBroadcasts'
      - 'KernelBootloader'
      - 'KernelModuleProvenance'
      - 'KernelModuleRestrictions'
      - 'NetworkIpForwardingState'
      - 'NetworkPathFilteringSettings'
      - 'NetworkRedirectState'
      - 'ProcMounts'
      - 'RestrictedDmesgReadPrivileges'
      - 'RestrictedKernelPointerReadPrivileges'
      - 'SecureSuidCoreDumps'
      - 'SecureFsLinks'
      - 'SyncookieState'
labels: [System]
supported_os: [Linux]
---
name: SudoersConfiguration
doc: Linux sudoers configuration.
sources:
- type: FILE
  attributes:
    paths: ['/etc/sudoers']
labels: [Authentication, Configuration Files]
supported_os: [Linux]
---
name: ThumbnailCacheFolder
doc: Thumbnail cache folder.
sources:
- type: FILE
  attributes: {paths: ['%%users.homedir%%/.thumbnails/**3']}
labels: [Users]
supported_os: [Linux]
---
name: ZeitgeistDatabase
doc: Zeitgeist user activity database.
sources:
- type: FILE
  attributes: {paths: ['%%users.homedir%%/.local/share/zeitgeist/activity.sqlite']}
labels: [Users, Logs]
urls: ['http://forensicswiki.org/wiki/Zeitgeist']
supported_os: [Linux]
---
name: KernelModules
doc: Kernel modules to be loaded on boot.
sources:
- type: FILE
  attributes:
    paths:
      - '/etc/modules.conf'
      - '/etc/modprobe.d/*'
supported_os: [Linux]
---
name: LoadedKernelModules
doc: Linux output of lsmod.
sources:
- type: COMMAND
  attributes:
    args: []
    cmd: /sbin/lsmod
supported_os: [Linux]
---
name: LinuxLSBInit
doc: Linux LSB-style init scripts.
sources:
- type: FILE
  attributes:
    paths:
      - '/etc/init.d/*'
      - '/etc/insserv.conf'
      - '/etc/insserv.conf.d/**'
labels: [Configuration Files, System]
supported_os: [Linux]
urls: ['https://wiki.debian.org/LSBInitScripts']
